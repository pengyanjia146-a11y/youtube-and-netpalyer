apply plugin: 'com.android.application'
apply plugin: 'kotlin-android'

// --- è‡ªåŠ¨ç‰ˆæœ¬ç®¡ç†é€»è¾‘ (ä¿ç•™) ---
def versionPropsFile = file('version.properties')
def versionProps = new Properties()

if (versionPropsFile.canRead()) {
    versionProps.load(new FileInputStream(versionPropsFile))
} else {
    versionProps['VERSION_CODE'] = '1'
    versionProps['VERSION_NAME'] = '1.0.0'
    versionProps.store(versionPropsFile.newWriter(), null)
}

task autoIncrementVersion {
    doLast {
        def code = versionProps['VERSION_CODE'].toInteger() + 1
        def name = "1.0." + code 
        versionProps['VERSION_CODE'] = code.toString()
        versionProps['VERSION_NAME'] = name
        versionProps.store(versionPropsFile.newWriter(), null)
        println("ğŸš€ Version Bumped to: " + name + " (" + code + ")")
    }
}

tasks.whenTaskAdded { task ->
    if (task.name == 'assembleDebug' || task.name == 'assembleRelease') {
        task.dependsOn autoIncrementVersion
    }
}
// ------------------------------

android {
    namespace 'com.pierfrancescosoffritti.androidyoutubeplayer.core.sampleapp'
    compileSdk 34

    defaultConfig {
        applicationId "com.pierfrancescosoffritti.androidyoutubeplayer.core.sampleapp"
        minSdk 21
        targetSdk 34
        
        // ä½¿ç”¨è‡ªåŠ¨ç®¡ç†çš„ç‰ˆæœ¬å·
        versionCode versionProps['VERSION_CODE'].toInteger()
        versionName versionProps['VERSION_NAME']

        testInstrumentationRunner "androidx.test.runner.AndroidJUnitRunner"
    }

    buildTypes {
        release {
            minifyEnabled false
            proguardFiles getDefaultProguardFile('proguard-android-optimize.txt'), 'proguard-rules.pro'
        }
    }
    compileOptions {
        sourceCompatibility JavaVersion.VERSION_1_8
        targetCompatibility JavaVersion.VERSION_1_8
    }
}

dependencies {
    implementation fileTree(dir: 'libs', include: ['*.jar'])
    
    implementation 'androidx.appcompat:appcompat:1.6.1'
    implementation 'androidx.constraintlayout:constraintlayout:2.1.4'
    implementation 'com.google.android.material:material:1.11.0'

    // ğŸ”´ æ ¸å¿ƒä¿®å¤ï¼šæ”¹ç”¨æœ¬åœ°æ¨¡å—ä¾èµ–ï¼Œè€Œä¸æ˜¯åœ¨çº¿åº“
    // è¿™æ ·æ‰èƒ½æ‰¾åˆ°æœ€æ–°çš„èµ„æºæ–‡ä»¶ (ayp_ic_play_36dp, showFullScreenButton ç­‰)
    implementation project(':core')
    implementation project(':custom-ui')

    testImplementation 'junit:junit:4.13.2'
    androidTestImplementation 'androidx.test.ext:junit:1.1.5'
    androidTestImplementation 'androidx.test.espresso:espresso-core:3.5.1'
}
