apply plugin: 'com.android.application'
apply plugin: 'kotlin-android'

// --- è‡ªåŠ¨ç‰ˆæœ¬ç®¡ç† ---
def versionPropsFile = file('version.properties')
def versionProps = new Properties()
if (versionPropsFile.canRead()) {
    versionProps.load(new FileInputStream(versionPropsFile))
} else {
    versionProps['VERSION_CODE'] = '1'
    versionProps['VERSION_NAME'] = '1.0.0'
    versionProps.store(versionPropsFile.newWriter(), null)
}
task autoIncrementVersion {
    doLast {
        def code = versionProps['VERSION_CODE'].toInteger() + 1
        def name = "1.0." + code 
        versionProps['VERSION_CODE'] = code.toString()
        versionProps['VERSION_NAME'] = name
        versionProps.store(versionPropsFile.newWriter(), null)
        println("ğŸš€ Version Bumped to: " + name + " (" + code + ")")
    }
}
tasks.whenTaskAdded { task ->
    if (task.name == 'assembleDebug' || task.name == 'assembleRelease') {
        task.dependsOn autoIncrementVersion
    }
}
// ----------------

android {
    namespace 'com.pierfrancescosoffritti.androidyoutubeplayer.core.sampleapp'
    compileSdk 36

    defaultConfig {
        applicationId "com.pierfrancescosoffritti.androidyoutubeplayer.core.sampleapp"
        minSdk 21
        targetSdk 36
        versionCode versionProps['VERSION_CODE'].toInteger()
        versionName versionProps['VERSION_NAME']
        testInstrumentationRunner "androidx.test.runner.AndroidJUnitRunner"
    }

    buildTypes {
        release {
            minifyEnabled false
            proguardFiles getDefaultProguardFile('proguard-android-optimize.txt'), 'proguard-rules.pro'
        }
    }
    
    compileOptions {
        sourceCompatibility JavaVersion.VERSION_17
        targetCompatibility JavaVersion.VERSION_17
    }
    kotlinOptions {
        jvmTarget = '17'
    }

    // ğŸ”´ æ ¸å¿ƒä¿®å¤ï¼šæ’é™¤æ‰€æœ‰æŠ¥é”™çš„æ— å…³ç¤ºä¾‹ä»£ç 
    sourceSets {
        main {
            java {
                exclude '**/examples/chromecastExample/**'
                exclude '**/examples/completeExample/**'
                exclude '**/examples/composeExample/**'
                exclude '**/examples/customUiExample/**'
                exclude '**/examples/defaultCustomUiExample/**'
                exclude '**/examples/fragmentExample/**'
                exclude '**/examples/fullscreenExample/**'
                exclude '**/examples/iFramePlayerOptionsExample/**'
                exclude '**/examples/liveVideoExample/**'
                exclude '**/examples/noLifecycleObserverExample/**'
                exclude '**/examples/pictureInPictureExample/**'
                exclude '**/examples/playerStateExample/**'
                exclude '**/examples/playlistExample/**'
                exclude '**/examples/recyclerViewExample/**'
                exclude '**/examples/viewPagerExample/**'
                // ä»…ä¿ç•™ simpleExample (æˆ‘ä»¬çš„æ··åˆæ’­æ”¾å™¨)
            }
        }
    }
}

dependencies {
    implementation fileTree(dir: 'libs', include: ['*.jar'])
    implementation 'androidx.appcompat:appcompat:1.6.1'
    implementation 'androidx.constraintlayout:constraintlayout:2.1.4'
    implementation 'com.google.android.material:material:1.11.0'
    implementation project(':core')
    implementation project(':custom-ui')
    testImplementation 'junit:junit:4.13.2'
    androidTestImplementation 'androidx.test.ext:junit:1.1.5'
    androidTestImplementation 'androidx.test.espresso:espresso-core:3.5.1'
}
